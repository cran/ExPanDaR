<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Joachim Gassen" />

<meta name="date" content="2019-04-06" />

<title>Customize ExPanD</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Customize ExPanD</h1>
<h4 class="author"><em>Joachim Gassen</em></h4>
<h4 class="date"><em>2019-04-06</em></h4>



<p>By default, ExPanD offers a set of sample modification and data exploration/visualization components that support a typical EDA workflow. In many situations however, your data does not need all of these components or you might want to center the user experience on a sub-set of these components. In addition, you might want to change the ordering of components, add additional information or even allow the user to define additional variables interactively. You can customize ExPanD along the following dimensions:</p>
<ul>
<li>Select components to include and their order</li>
<li>Add informative variable definitions</li>
<li>Customize components so that they display certain variables and specifications</li>
<li>Allow users to generate additional variables</li>
<li>Add html blocks to support the flow of your app</li>
</ul>
<p>This vignette will guide you through each of these opportunities by step-by-step developing a customized ExPanD app. The code in the vignette is additive, meaning that you can source each code block independently from the others to see how the ‘ExPanD’ app is changed by the customization step-by-step.</p>
<div id="select-components-to-include-and-their-order" class="section level2">
<h2>Select components to include and their order</h2>
<p>When you start ExPanD in default mode, e.g., by</p>
<p>ExPanD will include all available components in their default order:</p>
<table>
<colgroup>
<col width="31%"></col>
<col width="68%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>sample_selection</code></td>
<td align="left">A drop down menu to select the sample to be used and whether it should be balanced</td>
</tr>
<tr class="even">
<td align="left"><code>subset_factor</code></td>
<td align="left">A drop down menu to select a factor on which to limit the sample and an additional menu to select the value of that factor on which you want to focus the analysis</td>
</tr>
<tr class="odd">
<td align="left"><code>grouping</code></td>
<td align="left">A drop down menu that gives you the option to name a grouping factor. The grouping factor allows the user to focus certain components on a sub-sample defined by a value of that factor. Also, the grouping coponent contains the dialog four outlier treatments</td>
</tr>
<tr class="even">
<td align="left"><code>bar_chart</code></td>
<td align="left">A component displaying a bar chart reporting the observations by time period</td>
</tr>
<tr class="odd">
<td align="left"><code>missing_values</code></td>
<td align="left">A visual displaying the frequency of missing values for each variable and time period</td>
</tr>
<tr class="even">
<td align="left"><code>udvars</code></td>
<td align="left">A component that allows users to define additional variables (see below)</td>
</tr>
<tr class="odd">
<td align="left"><code>descriptive_table</code></td>
<td align="left">A descriptive table for all numerical and logical variables contained in the sample</td>
</tr>
<tr class="even">
<td align="left"><code>histogram</code></td>
<td align="left">A histogram to display the distribution of a chosen numerical or logical variable</td>
</tr>
<tr class="odd">
<td align="left"><code>ext_obs</code></td>
<td align="left">A list displaying the 5 most extreme observations for a chosen variable, overall or by time period</td>
</tr>
<tr class="even">
<td align="left"><code>by_group_bar_graph</code></td>
<td align="left">A bar graph that visualizes a chosen descriptive statistic by a chosen grouping factor</td>
</tr>
<tr class="odd">
<td align="left"><code>by_group_violin_graph</code></td>
<td align="left">A by group violin plot, where users can choose the variable and the grouping factor</td>
</tr>
<tr class="even">
<td align="left"><code>trend_graph</code></td>
<td align="left">A graph that visualizes the development of up to three variables over time</td>
</tr>
<tr class="odd">
<td align="left"><code>quantile_trend_graph</code></td>
<td align="left">A graph that visualizes the distribution of one chosen variable over time</td>
</tr>
<tr class="even">
<td align="left"><code>corrplot</code></td>
<td align="left">A visual representation of Spearman and Pearson correlations of the numerical and logical variables in the sample. Exact correlations are displayed when you hover above the respective cell with your mouse</td>
</tr>
<tr class="odd">
<td align="left"><code>scatter_plot</code></td>
<td align="left">A scatter plot, where you can present up to 4 dimensions of your data (x, y, size, color). You can choose whether you want a LOESS line to be displayed and whether you want your sample to be limited to 1,000 observations</td>
</tr>
<tr class="even">
<td align="left"><code>regression</code></td>
<td align="left">A regression component where you can estimate a linear or logit regression, with up to two fixed effect levels and standard error clustering</td>
</tr>
</tbody>
</table>
<p>To select the components that you want to display, you have two options: First, you can simply indicate the components that you want to <em>omit</em>. The remaining components stay in the original order. As an example, the ‘gapminder’ data set does not have any missing values and is a balanced sample. This mean that we can safely omit the sample selection component as well as the display of missing values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ExPanDaR)
<span class="kw">library</span>(gapminder)
<span class="kw">data</span>(gapminder)

<span class="kw">ExPanD</span>(<span class="dt">df =</span> gapminder, <span class="dt">cs_id =</span> <span class="st">&quot;country&quot;</span>, <span class="dt">ts_id =</span> <span class="st">&quot;year&quot;</span>, 
       <span class="dt">components =</span> <span class="kw">c</span>(<span class="dt">sample_selection =</span> <span class="ot">FALSE</span>, <span class="dt">missing_values =</span> <span class="ot">FALSE</span>))</code></pre></div>
<p>Alternatively, you can choose the components that you want to <em>include</em>. This also gives you the option to sort the components in your preferred order. Let us assume that we want our app to focus on the Preston curve association of GDP per capita and life expectancy in the ‘gapminder’ data. So maybe we want to include the following components:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ExPanDaR)
<span class="kw">library</span>(gapminder)
<span class="kw">data</span>(gapminder)

<span class="kw">ExPanD</span>(<span class="dt">df =</span> gapminder, <span class="dt">cs_id =</span> <span class="st">&quot;country&quot;</span>, <span class="dt">ts_id =</span> <span class="st">&quot;year&quot;</span>, 
       <span class="dt">components =</span> <span class="kw">c</span>(<span class="dt">descriptive_table =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">by_group_violin_graph =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">scatter_plot =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">regression =</span> <span class="ot">TRUE</span>))</code></pre></div>
<p>OK. While we are at it, we can also include an informative title and a short intro sentence.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ExPanDaR)
<span class="kw">library</span>(gapminder)
<span class="kw">data</span>(gapminder)

<span class="kw">ExPanD</span>(<span class="dt">df =</span> gapminder, <span class="dt">cs_id =</span> <span class="st">&quot;country&quot;</span>, <span class="dt">ts_id =</span> <span class="st">&quot;year&quot;</span>, 
       <span class="dt">title =</span> <span class="st">&quot;Explore the Preston Curve&quot;</span>,
       <span class="dt">abstract =</span> <span class="kw">paste</span>(<span class="st">&quot;This interactive display uses 'gapminder' data to&quot;</span>,
                        <span class="st">&quot;let you explore the Preston Curve. Scroll down and enjoy!&quot;</span>),
       <span class="dt">components =</span> <span class="kw">c</span>(<span class="dt">descriptive_table =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">by_group_violin_graph =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">scatter_plot =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">regression =</span> <span class="ot">TRUE</span>))</code></pre></div>
</div>
<div id="add-variable-definitions" class="section level2">
<h2>Add variable definitions</h2>
<p>When you look at the descriptive table you see that it does not offer self-explanatory variable names. Also, no tool-tips are displayed when you hover over the variable names with your mouse.</p>
<p>To add the tool-tip functionality, we need to specify a <code>df_def</code> data frame that describes the variables. The upside of this is that we no longer need to specify the cross-sectional and time series identifiers as these are also defined in the data frame</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ExPanDaR)
<span class="kw">library</span>(gapminder)
<span class="kw">data</span>(gapminder)

df_def &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">var_name =</span> <span class="kw">names</span>(gapminder),
  <span class="dt">var_def =</span> <span class="kw">c</span>(<span class="st">&quot;Name of the country&quot;</span>,
              <span class="st">&quot;Continent where country is located&quot;</span>,
              <span class="st">&quot;Year of data&quot;</span>,
              <span class="st">&quot;Life expectancy in years at birth&quot;</span>,
              <span class="st">&quot;Population in million&quot;</span>,
              <span class="st">&quot;Gross Domestic Product (GDP) per capita&quot;</span>),
  <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;cs_id&quot;</span>, <span class="st">&quot;factor&quot;</span>, <span class="st">&quot;ts_id&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dv">3</span>))
)

gapminder<span class="op">$</span>pop &lt;-<span class="st"> </span>gapminder<span class="op">$</span>pop <span class="op">/</span><span class="st"> </span><span class="fl">1e6</span>

<span class="kw">ExPanD</span>(<span class="dt">df =</span> gapminder,
       <span class="dt">title =</span> <span class="st">&quot;Explore the Preston Curve&quot;</span>,
       <span class="dt">abstract =</span> <span class="kw">paste</span>(<span class="st">&quot;This interactive display uses 'gapminder' data to&quot;</span>,
                        <span class="st">&quot;let you explore the Preston Curve. Scroll down and enjoy!&quot;</span>),
       <span class="dt">components =</span> <span class="kw">c</span>(<span class="dt">descriptive_table =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">by_group_violin_graph =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">quantile_trend_graph =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">scatter_plot =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">regression =</span> <span class="ot">TRUE</span>),
       <span class="dt">df_def =</span> df_def)</code></pre></div>
<p>Now tool-tips for the descriptive table inform about our variables. Neat.</p>
</div>
<div id="customize-components-so-that-they-display-certain-variables-and-specifications" class="section level2">
<h2>Customize components so that they display certain variables and specifications</h2>
<p>When you scroll down the components you will see that the scatter plot is not showing the typical Preston curve by default. We want to change that so that the scatter plot is based on the full sample and includes a LOESS line. It should show GDP per capita as X and life expectancy as Y, with population defining the size of the data points and the continent their color. Also, we want to estimate a panel model of life expectancy with country and year firm fixed effects, two-way clustered standard errors and GDP per capita as explanatory variable (Population is time constant in the ‘gapminder’ data set and as such subsumed by country fixed effects).</p>
<p>There are two ways to achieve that, a simple one and a hard one.</p>
<p>First, the simple one: Make the desired changes in the app, save the configuration of the app to a file that you can remember (button towards the bottom of the page), read that file with <code>readRDS()</code> into your environment and provide the resulting list as the parameter <code>config_list</code> to the <code>ExPanD()</code> function call. Below, I assume that you saved the configuration of the app as <code>my_config.RDS</code> to the working directory.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ExPanDaR)
<span class="kw">library</span>(gapminder)
<span class="kw">data</span>(gapminder)

df_def &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">var_name =</span> <span class="kw">names</span>(gapminder),
  <span class="dt">var_def =</span> <span class="kw">c</span>(<span class="st">&quot;Name of the country&quot;</span>,
              <span class="st">&quot;Continent where country is located&quot;</span>,
              <span class="st">&quot;Year of data&quot;</span>,
              <span class="st">&quot;Life expectancy in years at birth&quot;</span>,
              <span class="st">&quot;Population in million&quot;</span>,
              <span class="st">&quot;Gross Domestic Product (GDP) per capita&quot;</span>),
  <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;cs_id&quot;</span>, <span class="st">&quot;factor&quot;</span>, <span class="st">&quot;ts_id&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dv">3</span>))
)

gapminder<span class="op">$</span>pop &lt;-<span class="st"> </span>gapminder<span class="op">$</span>pop <span class="op">/</span><span class="st"> </span><span class="fl">1e6</span>

clist &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;my_config.RDS&quot;</span>)

<span class="kw">ExPanD</span>(<span class="dt">df =</span> gapminder,
       <span class="dt">title =</span> <span class="st">&quot;Explore the Preston Curve&quot;</span>,
       <span class="dt">abstract =</span> <span class="kw">paste</span>(<span class="st">&quot;This interactive display uses 'gapminder' data to&quot;</span>,
                        <span class="st">&quot;let you explore the Preston Curve. Scroll down and enjoy!&quot;</span>),
       <span class="dt">components =</span> <span class="kw">c</span>(<span class="dt">descriptive_table =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">by_group_violin_graph =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">scatter_plot =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">regression =</span> <span class="ot">TRUE</span>),
       <span class="dt">df_def =</span> df_def,
       <span class="dt">config_list =</span> clist)</code></pre></div>
<p>Now the hard one. You can specify the changes that you want to apply to the default configuration directly in the code. Take a look at <code>clist</code> to understand how the data is structured. I hope that most list member names are somewhat self explanatory.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ExPanDaR)
<span class="kw">library</span>(gapminder)
<span class="kw">data</span>(gapminder)

df_def &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">var_name =</span> <span class="kw">names</span>(gapminder),
  <span class="dt">var_def =</span> <span class="kw">c</span>(<span class="st">&quot;Name of the country&quot;</span>,
              <span class="st">&quot;Continent where country is located&quot;</span>,
              <span class="st">&quot;Year of data&quot;</span>,
              <span class="st">&quot;Life expectancy at birth, in years&quot;</span>,
              <span class="st">&quot;Population in million&quot;</span>,
              <span class="st">&quot;Gross Domestic Product (GDP) per capita in US-$, inflation-adjusted&quot;</span>),
  <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;cs_id&quot;</span>, <span class="st">&quot;factor&quot;</span>, <span class="st">&quot;ts_id&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dv">3</span>)),
  <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>
)

gapminder<span class="op">$</span>pop &lt;-<span class="st"> </span>gapminder<span class="op">$</span>pop <span class="op">/</span><span class="st"> </span><span class="fl">1e6</span>

clist &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">scatter_x =</span> <span class="st">&quot;gdpPercap&quot;</span>,
  <span class="dt">scatter_y =</span> <span class="st">&quot;lifeExp&quot;</span>,
  <span class="dt">scatter_size =</span> <span class="st">&quot;pop&quot;</span>,
  <span class="dt">scatter_color =</span> <span class="st">&quot;continent&quot;</span>,
  <span class="dt">scatter_loess =</span> <span class="ot">TRUE</span>,
  <span class="dt">scatter_sample =</span> <span class="ot">FALSE</span>,
  
  <span class="dt">reg_y =</span> <span class="st">&quot;lifeExp&quot;</span>,
  <span class="dt">reg_x =</span> <span class="st">&quot;gdpPercap&quot;</span>,
  <span class="dt">reg_fe1 =</span> <span class="st">&quot;country&quot;</span>,
  <span class="dt">reg_fe2 =</span> <span class="st">&quot;year&quot;</span>,
  <span class="dt">cluster =</span> <span class="st">&quot;4&quot;</span> <span class="co"># No this is hard to guess 1: none, 2: first FE, 3: second FE, 4: both FE</span>
)

<span class="kw">ExPanD</span>(<span class="dt">df =</span> gapminder,
       <span class="dt">title =</span> <span class="st">&quot;Explore the Preston Curve&quot;</span>,
       <span class="dt">abstract =</span> <span class="kw">paste</span>(<span class="st">&quot;This interactive display uses 'gapminder' data to&quot;</span>,
                        <span class="st">&quot;let you explore the Preston Curve. Scroll down and enjoy!&quot;</span>),
       <span class="dt">components =</span> <span class="kw">c</span>(<span class="dt">descriptive_table =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">by_group_violin_graph =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">scatter_plot =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">regression =</span> <span class="ot">TRUE</span>),
       <span class="dt">df_def =</span> df_def,
       <span class="dt">config_list =</span> clist)</code></pre></div>
<p>Now we have our customized components well documented in code. The scatter plot exhibits the Preston curve. The association is non-linear, potentially explaining the negative coefficient in the panel model. Maybe we want to allow the user to address this issue on-the-fly by defining additional variables?</p>
</div>
<div id="allow-users-to-generate-additional-variables" class="section level2">
<h2>Allow users to generate additional variables</h2>
<p>This can be achieved by adding a component <code>udvars</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ExPanDaR)
<span class="kw">library</span>(gapminder)
<span class="kw">data</span>(gapminder)

df_def &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">var_name =</span> <span class="kw">names</span>(gapminder),
  <span class="dt">var_def =</span> <span class="kw">c</span>(<span class="st">&quot;Name of the country&quot;</span>,
              <span class="st">&quot;Continent where country is located&quot;</span>,
              <span class="st">&quot;Year of data&quot;</span>,
              <span class="st">&quot;Life expectancy in years at birth&quot;</span>,
              <span class="st">&quot;Population in million&quot;</span>,
              <span class="st">&quot;Gross Domestic Product (GDP) per capita&quot;</span>),
  <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;cs_id&quot;</span>, <span class="st">&quot;factor&quot;</span>, <span class="st">&quot;ts_id&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dv">3</span>)),
  <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>
)

gapminder<span class="op">$</span>pop &lt;-<span class="st"> </span>gapminder<span class="op">$</span>pop <span class="op">/</span><span class="st"> </span><span class="fl">1e6</span>

clist &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">scatter_x =</span> <span class="st">&quot;gdpPercap&quot;</span>,
  <span class="dt">scatter_y =</span> <span class="st">&quot;lifeExp&quot;</span>,
  <span class="dt">scatter_size =</span> <span class="st">&quot;pop&quot;</span>,
  <span class="dt">scatter_color =</span> <span class="st">&quot;continent&quot;</span>,
  <span class="dt">scatter_loess =</span> <span class="ot">TRUE</span>,
  <span class="dt">scatter_sample =</span> <span class="ot">FALSE</span>,
  
  <span class="dt">reg_y =</span> <span class="st">&quot;lifeExp&quot;</span>,
  <span class="dt">reg_x =</span> <span class="st">&quot;gdpPercap&quot;</span>,
  <span class="dt">reg_fe1 =</span> <span class="st">&quot;country&quot;</span>,
  <span class="dt">reg_fe2 =</span> <span class="st">&quot;year&quot;</span>,
  <span class="dt">cluster =</span> <span class="st">&quot;4&quot;</span> <span class="co"># No this is hard to guess 1: none, 2: first FE, 3: second FE, 4: both FE</span>
)

<span class="kw">ExPanD</span>(<span class="dt">df =</span> gapminder,
       <span class="dt">title =</span> <span class="st">&quot;Explore the Preston Curve&quot;</span>,
       <span class="dt">abstract =</span> <span class="kw">paste</span>(<span class="st">&quot;This interactive display uses 'gapminder' data to&quot;</span>,
                        <span class="st">&quot;let you explore the Preston Curve. Scroll down and enjoy!&quot;</span>),
       <span class="dt">components =</span> <span class="kw">c</span>(<span class="dt">descriptive_table =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">by_group_violin_graph =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">scatter_plot =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">udvars =</span> <span class="ot">TRUE</span>,
                      <span class="dt">regression =</span> <span class="ot">TRUE</span>),
       <span class="dt">df_def =</span> df_def,
       <span class="dt">config_list =</span> clist)</code></pre></div>
<p>This generates another component in your app allowing the user to define additional variables. It is positioned just below the scatter plot. For fun and jiggles, you can define <code>logGpdPercap &lt;- log(gdpPercap)</code> and verify using the scatter plot that using a log-transformed explanatory variable makes the association more linear, reflecting also in a now positive coefficient in the regression model. If you worry about security, the code that is passed to the server via the user variable definition component is sandboxed in a sense that is only includes the variables of the sample and the functions listed in the help text of the component.</p>
<p>Time to move to the finishing touches.</p>
</div>
<div id="add-html-blocks-to-support-the-flow-of-your-app" class="section level2">
<h2>Add html blocks to support the flow of your app</h2>
<p>From time to time it might be useful to include some additional text or other info in between components. For that, you have the option to include an arbitrary number of HTML blocks as additional components. Each html block will be wrapped in a fluid row, so you can use columns similar to what you would do in shiny.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ExPanDaR)
<span class="kw">library</span>(gapminder)
<span class="kw">data</span>(gapminder)

df_def &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">var_name =</span> <span class="kw">names</span>(gapminder),
  <span class="dt">var_def =</span> <span class="kw">c</span>(<span class="st">&quot;Name of the country&quot;</span>,
              <span class="st">&quot;Continent where country is located&quot;</span>,
              <span class="st">&quot;Year of data&quot;</span>,
              <span class="st">&quot;Life expectancy in years at birth&quot;</span>,
              <span class="st">&quot;Population in million&quot;</span>,
              <span class="st">&quot;Gross Domestic Product (GDP) per capita&quot;</span>),
  <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;cs_id&quot;</span>, <span class="st">&quot;factor&quot;</span>, <span class="st">&quot;ts_id&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dv">3</span>)),
  <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>
)

gapminder<span class="op">$</span>pop &lt;-<span class="st"> </span>gapminder<span class="op">$</span>pop <span class="op">/</span><span class="st"> </span><span class="fl">1e6</span>

clist &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">scatter_x =</span> <span class="st">&quot;gdpPercap&quot;</span>,
  <span class="dt">scatter_y =</span> <span class="st">&quot;lifeExp&quot;</span>,
  <span class="dt">scatter_size =</span> <span class="st">&quot;pop&quot;</span>,
  <span class="dt">scatter_color =</span> <span class="st">&quot;continent&quot;</span>,
  <span class="dt">scatter_loess =</span> <span class="ot">TRUE</span>,
  <span class="dt">scatter_sample =</span> <span class="ot">FALSE</span>,
  
  <span class="dt">reg_y =</span> <span class="st">&quot;lifeExp&quot;</span>,
  <span class="dt">reg_x =</span> <span class="st">&quot;gdpPercap&quot;</span>,
  <span class="dt">reg_fe1 =</span> <span class="st">&quot;country&quot;</span>,
  <span class="dt">reg_fe2 =</span> <span class="st">&quot;year&quot;</span>,
  <span class="dt">cluster =</span> <span class="st">&quot;4&quot;</span> <span class="co"># No this is hard to guess 1: none, 2: first FE, 3: second FE, 4: both FE</span>
)

html_blocks &lt;-<span class="st"> </span><span class="kw">c</span>(
  <span class="kw">paste</span>(<span class="st">'&lt;div class=&quot;col-sm-2&quot;&gt;&lt;h3&gt;Variation of life expectancy'</span>,
        <span class="st">&quot;across regions and income levels&lt;/h3&gt;&lt;/div&gt;&quot;</span>,
        <span class="st">'&lt;div class=&quot;col-sm-10&quot;&gt;'</span>,
        <span class="st">&quot;&lt;p&gt;&amp;nbsp;&lt;/p&gt;As you see below, life expectancy varies widely&quot;</span>,
        <span class="st">&quot;across countries and continents. One potential reason for this&quot;</span>,
        <span class="st">&quot;variation is the difference in income levels across countries.&quot;</span>,
        <span class="st">&quot;This association is visualized by the&quot;</span>,
        <span class="st">&quot;&lt;a href=https://en.wikipedia.org/wiki/Preston_curve&gt;&quot;</span>,
        <span class="st">&quot;Preston Curve&lt;/a&gt; that you also find below.&quot;</span>,
        <span class="st">&quot;&lt;/div&gt;&quot;</span>),
  <span class="kw">paste</span>(<span class="st">'&lt;div class=&quot;col-sm-2&quot;&gt;&lt;h3&gt;Transform variables&lt;/h3&gt;&lt;/div&gt;'</span>, 
        <span class="st">'&lt;div class=&quot;col-sm-10&quot;&gt;'</span>,
        <span class="st">&quot;The Preston Curve is far from&quot;</span>,
        <span class="st">&quot;linear. Maybe you can come up with a transformation&quot;</span>,
        <span class="st">&quot;of GDP per capita that makes the association&quot;</span>,
        <span class="st">&quot;a little bit more well behaved?&quot;</span>,
        <span class="st">&quot;Use the dialog below to define a transformed&quot;</span>,
        <span class="st">&quot;measure of GDP per capita and assess its association&quot;</span>,
        <span class="st">&quot;with life expectancy in the scatter plot above.&quot;</span>,
        <span class="st">&quot;&lt;/div&gt;&quot;</span>),
  <span class="kw">paste</span>(<span class="st">'&lt;div class=&quot;col-sm-2&quot;&gt;&lt;h3&gt;Assess Robustness&lt;/h3&gt;&lt;/div&gt;'</span>,
        <span class="st">'&lt;div class=&quot;col-sm-10&quot;&gt;'</span>,
        <span class="st">&quot;You see below that the linear regression coefficient&quot;</span>,
        <span class="st">&quot;for GDP per capita is &lt;i&gt;negative&lt;/i&gt;&quot;</span>,
        <span class="st">&quot;and signficant in a panel model with country and year&quot;</span>,
        <span class="st">&quot;fixed effects.&quot;</span>,
        <span class="st">&quot;Does this also hold when you use a log-transformed version&quot;</span>,
        <span class="st">&quot;of GDP per capita?&quot;</span>,
        <span class="st">&quot;&lt;/div&gt;&quot;</span>)
)

<span class="kw">ExPanD</span>(<span class="dt">df =</span> gapminder,
       <span class="dt">title =</span> <span class="st">&quot;Explore the Preston Curve&quot;</span>,
       <span class="dt">abstract =</span> <span class="kw">paste</span>(<span class="st">&quot;This interactive display uses 'gapminder' data to&quot;</span>,
                        <span class="st">&quot;let you explore the Preston Curve. Scroll down and enjoy!&quot;</span>),
       <span class="dt">components =</span> <span class="kw">c</span>(<span class="dt">descriptive_table =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">html_block =</span> <span class="ot">TRUE</span>,
                      <span class="dt">by_group_violin_graph =</span> <span class="ot">TRUE</span>, 
                      <span class="dt">scatter_plot =</span> <span class="ot">TRUE</span>,
                      <span class="dt">html_block =</span> <span class="ot">TRUE</span>,
                      <span class="dt">udvars =</span> <span class="ot">TRUE</span>,
                      <span class="dt">html_block =</span> <span class="ot">TRUE</span>,
                      <span class="dt">regression =</span> <span class="ot">TRUE</span>),
       <span class="dt">df_def =</span> df_def,
       <span class="dt">config_list =</span> clist,
       <span class="dt">html_blocks =</span> html_blocks)</code></pre></div>
<p>This is it. Now we have a customized version of ExPanD focusing on communicating the robsutness of the Preston Curve. If you do not want to run the code yourself, you can take a quick look at the customized version <a href="https://jgassen.shinyapps.io/expand_gapminder">here</a>.</p>
<p>If you want to take customization to the next level, you can always fork the code of the ‘ExPanDaR’ package on GitHub. The code for the shiny app is in the <code>inst/app</code> folder of the package.</p>
<p>Enjoy.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
